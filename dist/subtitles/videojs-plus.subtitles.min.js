!function(t){"use strict";function e(){return e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},e.apply(this,arguments)}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var i=t.getComponent("SettingOptionItem"),o=function(t){function i(n,i){var o;return o=t.call(this,n,e({},i,{name:"SubtitleSettingMenuItem",label:"Subtitles",icon:"vjs-icon-subtitles",entries:n.options_.subtitles||[]}))||this,o.addClass("vjs-setting-subtitles"),n.on("subtitles",function(t,e){o.setEntries(e.map(function(t,e){return{label:t.label,value:e,defalut:t.default}}).concat([{label:"Close Subtitles",value:-1,defalut:!1}])),o.show()}),o}return n(i,t),i.prototype.update=function(e){t.prototype.update.call(this,e),this.player_.subtitles().pick(e.value)},i}(i);t.getComponent("SettingMenuButton").prototype.options_.entries.push("SubtitleSettingMenuItem"),t.registerComponent("SubtitleSettingMenuItem",o);var a=function(t){function e(e,n){var i;i=t.call(this,e,n)||this,i.flag=null,i.track=null;var o,a=function(){clearTimeout(o);var t=i.values(),n=t.find(function(t){return"showing"===t.mode})||{},a=n.label||n.id;o=setTimeout(function(){i.flag!==a&&(i.flag=a,e.trigger("subtitlechange",{index:t.indexOf(n),label:n.label||""}))},10)};return e.textTracks().on("change",a),e.on("dispose",function(){e.textTracks().off("change",a)}),i}n(e,t);var i=e.prototype;return i.values=function(){for(var t=this.player.textTracks(),e=[],n=0;n<t.length;n++)"subtitles"===t[n].kind&&e.push(t[n]);return e},i.load=function(t){var e=this;void 0===t&&(t=[]);var n=this.player,i=t.map(function(t){return Object.assign({},t)});i&&i.length&&(this.remove(),i.forEach(function(t){e.flag&&(t.default=t.label===e.flag);var i=n.addRemoteTextTrack(t,!0);t.default&&(e.flag=t.label,e.track=i.track,i.track.mode="showing")}),n.trigger("subtitles",i))},i.remove=function(){var t=this;this.values().forEach(function(e){t.player.removeRemoteTextTrack(e)})},i.pick=function(t){var e=this.values(),n=e[t];n?(this.track.mode="disabled",this.track=n,n.mode="showing"):this.track.mode="disabled"},e}(t.getPlugin("plugin"));t.hook("setup",function(t){t.ready(function(){t.subtitles().load(t.options_.subtitles)})}),t.registerPlugin("subtitles",a)}(videojs);
