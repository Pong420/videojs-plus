!function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var n=t.getComponent("SettingOptionalItem"),i=function(t){function n(e,n){var i;return i=t.call(this,e,Object.assign(n,{name:"SubtitleSettingMenuItem",label:"Subtitles",icon:"vjs-icon-subtitles",entries:n.subtitles||[]}))||this,i.addClass("vjs-setting-subtitles"),i}return e(n,t),n.prototype.update=function(e){t.prototype.update.call(this,e),this.player_.subtitles().pick(e.value)},n}(n);t.getComponent("SettingMenuButton").prototype.options_.entries.push("SubtitleSettingMenuItem"),t.registerComponent("SubtitleSettingMenuItem",i);var a=function(t){function n(e,n){var i;i=t.call(this,e,n)||this,i.flag=null,i.track=null;var a;return e.textTracks().on("change",function(){clearTimeout(a);var t=i.values(),n=t.find(function(t){return"showing"===t.mode})||{},o=n.label||n.id;a=setTimeout(function(){i.flag!==o&&(i.flag=o,e.trigger("subtitlechange",{index:t.indexOf(n),label:n.label||""}))},10)}),i}e(n,t);var i=n.prototype;return i.values=function(){for(var t=this.player.textTracks(),e=[],n=0;n<t.length;n++)"subtitles"===t[n].kind&&e.push(t[n]);return e},i.load=function(t){var e=this;void 0===t&&(t=[]);var n=this.player,i=t.map(function(t){return Object.assign({},t)});if(i&&i.length){this.remove(),i.forEach(function(t){e.flag&&(t.default=t.label===e.flag);var i=n.addRemoteTextTrack(t,!0);t.default&&(e.flag=t.label,e.track=i.track,i.track.mode="showing")});var a=n.findChild("SubtitlesMenuItem")[0].component;a.setEntries(i.map(function(t,e){return{label:t.label,value:e,defalut:t.default}}).concat([{label:"Close Subtitles",value:-1,defalut:!1}])),a.show(),n.trigger("subtitles",i)}},i.remove=function(){var t=this;this.values().forEach(function(e){t.player.removeRemoteTextTrack(e)})},i.pick=function(t){var e=this.values(),n=e[t];n?(this.track.mode="disabled",this.track=n,n.mode="showing"):this.track.mode="disabled"},n}(t.getPlugin("plugin"));t.hook("setup",function(t){t.ready(function(){t.subtitles().load(t.options_.subtitles)})}),t.registerPlugin("subtitles",a)}(videojs);
