!function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var i=function(){function t(t,e){this.values=t.slice(0),this.index_=e||0,this.loop_=!0}var e=t.prototype;return e.index=function(t){if(void 0===t)return this.index_;this.index_=Math.max(0,Math.min(t,this.values.length-1))},e.loop=function(t){if(void 0===t)return this.loop_;this.loop_=!!t},e.calc=function(t){var e=this.index_+t,n=this.values.length;return this.loop_?(n+e)%n:Math.max(0,Math.min(e,n-1))},e.step=function(t){return this.index_=this.calc(t),this.values[this.index_]},e.current=function(){return this.values[this.index_]},e.next=function(){return this.step(1)},e.prev=function(){return this.step(-1)},e.ended=function(){return this.index_===this.values.length-1},t}(),o=t.getComponent("ClickableComponent"),a=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var i=n.prototype;return i.buildCSSClass=function(){return"vjs-playnext-spinner"},i.createEl=function(){var e=t.prototype.createEl.call(this,"div",{innerHTML:'\n        <div class="vjs-icon-placeholder vjs-icon-play"></div>\n        <svg width="60" height="60" viewbox="0 0 60 60">\n          <circle cx="30" cy="30" r="30"/>\n          <path class="vjs-playnext-spinner-border" fill="#FFF" transform="translate(30, 30)"/>\n          <circle id="donut" cx="30" cy="30" r="27"/>\n        </svg>\n      '});return this.path=e.querySelector("path"),e},i.handleClick=function(){this.player_.getChild("BeforePlayNextLayer").timeup()},n}(o);a.prototype.controlText_="PlayNext",t.registerComponent("PlayNextSpinner",a);var l=t.getComponent("Component"),s=function(i){function o(t,e){var o;o=i.call(this,t,e)||this,o.addChild("PlayNextSpinner",{},2),o.addChild("CancelPlayNextEl",{text:"&#10005;",className:"vjs-cancel-playnext-cross"},{},2),o.addChild("CancelPlayNextEl",{text:"Cancel",className:"vjs-cancel-playnext-button"},{},2),o.originPoster=t.poster()||t.playlist.current().poster,t.poster(o.getNext().poster);var a=o.dispose.bind(n(n(o))),l=["timeupdate","loadstart"];return t.one(l,a),o.on("dispose",function(){t.off(l,a),t.removeClass("vjs-play-next-ready")}),o.countdown(t.options_.playNextCountDown),t.addClass("vjs-play-next-ready"),o}e(o,i);var a=o.prototype;return a.getNext=function(){var t=this.player_.playlist;return this.next=t.values[t.calc(1)],this.next},a.createEl=function(){var e=this.getNext().title,n=t.dom.createEl("div",{className:"vjs-before-playnext"});return this.contentEl_=t.dom.createEl("div",{className:"vjs-before-playnext-content",innerHTML:'\n        <div class="vjs-upnext-text">'+this.localize("Up Next")+'</div>\n        <div class="vjs-playnext-title">\n            <div>'+e+"</div>\n        </div>\n      "}),n.appendChild(this.contentEl_),n},a.countdown=function(t){if(void 0===t&&(t=10),0==t)return this.timeup(),!1;var e=this,n=0,i=Math.PI,o=t;o=o/360*1e3,function t(){n++,n%=360;var a=n*i/180,l=125*Math.sin(a),s=-125*Math.cos(a),r=n>180?1:0,p="M 0 0 v -125 A 125 125 1 "+r+" 1 "+l+" "+s+" z";e.getChild("PlayNextSpinner").path.setAttribute("d",p),0===n?e.timeup():e.timer=setTimeout(t,o)}()},a.timeup=function(){this.player_.playlist.next(),this.player_.playlist.play(),this.dispose()},a.cancel=function(){return this.player_.poster(this.originPoster),this},a.dispose=function(){clearTimeout(this.timer),this.player_.removeChild(this),i.prototype.dispose.call(this)},o}(l),r=function(){var t=this.player_,e=t.playlist,n=e.loop()||!e.ended();if(e.autoPlayNext()&&n){var i=t.getChild("ControlBar"),o=t.children().indexOf(i)-1;t.addChild("BeforePlayNextLayer",{},o)}else t.poster(e.current().poster||"")};t.registerPlugin("playNext",r),t.registerComponent("BeforePlayNextLayer",s);var p=t.getComponent("SettingMenuButton"),c=t.getComponent("SettingOnOffItem"),u=function(t){function n(e,n){var i;return i=t.call(this,e,{name:"ToggleAutoPlayNext",label:"Autoplay",icon:"vjs-icon-next-item"})||this,i.updateVisibility(),i.addClass("vjs-setting-autoplay"),e.on("playlist",function(){i.updateVisibility(),i.update(e.playlist.autoPlayNext_)}),e.on("autoplaynext",function(t,e){i.update(e)}),i}e(n,t);var i=n.prototype;return i.updateVisibility=function(){var t=this.player_.playlist;t&&t.values.length>1?this.show():this.hide()},i.update=function(e){t.prototype.update.call(this,e),this.player_.playlist.autoPlayNext_!==this.active&&this.player_.playlist.autoPlayNext(this.active)},n}(c);t.registerComponent("ToggleAutoPlayNext",u),p.prototype.options_.entries.splice(0,0,"ToggleAutoPlayNext");var h=t.getComponent("Button"),d=function(t){function i(e,i){var o;return o=t.call(this,e,i)||this,o.updateVisibility(),o.controlText(i.controlText),e.on("playlist",o.updateVisibility.bind(n(n(o)))),o}e(i,t);var o=i.prototype;return o.buildCSSClass=function(){return this.options_.className+" "+t.prototype.buildCSSClass.call(this)},o.updateVisibility=function(){var t=this.player_.playlist;t&&t.values.length>1?this.show():this.hide()},o.createEl=function(e,n,i){return t.prototype.createEl.call(this,e,{innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder '+this.options_.icon+'"></span>'},i)},o.handleClick=function(){var t=this.options_.controlText.toLowerCase();this.player_.playlist[t](),this.player_.playlist.play()},i}(h),y=t.getComponent("ControlBar"),v=y.prototype.options_.children,x=v.indexOf("PlayToggle");-1!==x&&(v.splice(0,0,{name:"PrevNextButton",className:"vjs-prev-control",icon:"vjs-icon-previous-item",controlText:"Prev"}),v.splice(x+2,0,{name:"PrevNextButton",className:"vjs-next-control",icon:"vjs-icon-next-item",controlText:"Next"})),t.registerComponent("PrevNextButton",d);var f=t.getComponent("ClickableComponent"),_=function(t){function n(e,n){var i;return i=t.call(this,e,n)||this,i.el_.querySelector(".vjs-icon-placeholder").innerHTML=i.localize(n.text),i}e(n,t);var i=n.prototype;return i.buildCSSClass=function(){return"vjs-cancel-playnext "+this.options_.className},i.handleClick=function(){this.player_.getChild("BeforePlayNextLayer").cancel().dispose()},n}(f);_.prototype.controlText_="Cancel PlayNext",t.registerComponent("CancelPlayNextEl",_);var g=function(t){function n(e,n,i){var o;return void 0===i&&(i=0),o=t.call(this,n,i)||this,o.player_=e,o.loadPoster_=!0,o.autoPlayNext_=!0,o.play(i),e.off("ended",e.playNext),e.on("ended",e.playNext),o}e(n,t);var i=n.prototype;return i.autoPlayNext=function(t){if(void 0===t)return this.autoPlayNext_;this.autoPlayNext_=!!t,this.player_.trigger("autoplaynext",this.autoPlayNext_)},i.play=function(t){void 0!==t&&this.index(t);var e=this.current(),n=e.poster,i=e.sources,o=e.title,a=this.player_,l=function(){a.poster(n||"")};a.title(""),a.poster(""),this.loadPoster_?(this.loadPoster_=!1,a.autoplay()?a.one("autoplay-failure",l):l()):a.one("loadedmetadata",function(){a.play()}),"none"!==a.preload()&&(a.addClass("vjs-waiting"),a.one("loadedmetadata",function(){a.removeClass("vjs-waiting")})),a.src(i),a.title(o||""),a.trigger("playlistchange",Object.assign(this.current(),{index:this.index()}))},n}(i);t.registerPlugin("setPlayList",function(t){var e=this.player_;e.playlist=new g(e,t),e.trigger("playlist")}),t.hook("setup",function(t){var e=t.options_.playlist||[];e.length&&t.setPlayList(e)})}(videojs);
