!function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var i=function(){function t(t,e){this.values=t.slice(0),this.index_=e||0,this.loop_=!0}var e=t.prototype;return e.index=function(t){if(void 0===t)return this.index_;this.index_=Math.max(0,Math.min(t,this.values.length-1))},e.loop=function(t){if(void 0===t)return this.loop_;this.loop_=!!t},e.calc=function(t){var e=this.index_+t,i=this.values.length;return this.loop_?(i+e)%i:Math.max(0,Math.min(e,i-1))},e.step=function(t){return this.index_=this.calc(t),this.values[this.index_]},e.current=function(){return this.values[this.index_]},e.next=function(){return this.step(1)},e.prev=function(){return this.step(-1)},e.ended=function(){return this.index_===this.values.length-1},t}(),n=t.getComponent("SettingOptionalItem"),o=function(t){function i(e,i){var n;return n=t.call(this,e,Object.assign(i,{name:"QualitySettingItem",label:"Quality",icon:"vjs-icon-hd",entries:i.quality||[]}))||this,n.addClass("vjs-setting-quality"),n}return e(i,t),i.prototype.update=function(e){t.prototype.update.call(this,e),this.player_.quality.pick(e.value)},i}(n);t.getComponent("SettingMenuButton").prototype.options_.entries.push("QualitySettingItem"),t.registerComponent("QualityItem",o);var u=function(t){function i(e,i,n){var o;return void 0===n&&(n=0),o=t.call(this,i,n)||this,o.player=e,o.pick(n,!0),o}return e(i,t),i.prototype.pick=function(t,e){void 0!==t&&this.index(t);var i=this.player,n=this.current(),o=i.ended()?0:i.currentTime();!e&&o&&i.one("loadedmetadata",function(){i.one("canplaythrough",function(){i.currentTime(o)}),i.play()}),i.src(n.sources),i.trigger("qualitychange",Object.assign(n,{index:this.index()}))},i}(i),r=function(t,e){void 0===e&&(e=0);var i=this.player_,n=i.findChild("QualityItem")[0].component;i.quality=new u(i,t,e),n.setEntries(t.map(function(t,e){return{label:t.label,value:e,defalut:t.default}})),n.show(),i.trigger("quality")};t.registerPlugin("setQuality",r),t.hook("setup",function(t){var e=t.options_,i=e.quality,n=e.defaultQualityLevel;i&&i.length&&t.setQuality(i,n)})}(videojs);
