!function(t){"use strict";function e(){return e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},e.apply(this,arguments)}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var i="default"in t?t.default:t,r=t.getComponent("ClickableComponent"),o=function(t){function i(n,i){var r;return r=t.call(this,n,e({name:"ExitPipButton"},i))||this,r.addClass("vjs-exit-pip-button"),r.el_.querySelector(".vjs-icon-placeholder").innerHTML="&#10005;",r}return n(i,t),i.prototype.handleClick=function(){this.options_.parentPlayer.pictureInPicture().exit()},i}(r);o.prototype.controlText_="Exit Pictutre In Pictutre",t.registerComponent("ExitPipButton",o);var a=t.getComponent("Component"),p=function(t){function e(e,n){var i;return i=t.call(this,e,n)||this,e.addChild(new o(e,{parentPlayer:n.parentPlayer})),i.addChild(e),n.wrapper||(i.addClass("vjs-pip-player-wrapper"),document.body.appendChild(i.el_)),i}return n(e,t),e.prototype.createEl=function(){return this.options_.wrapper?this.options_.wrapper:t.prototype.createEl.call(this)},e}(a);t.registerComponent("PipPlayerWrapper",p);var l=t.getComponent("Button"),s=function(t){function e(e,n){var i;return i=t.call(this,e,n)||this,i.el_.querySelector(".vjs-icon-placeholder").className+=" vjs-icon-picture-in-picture",i}n(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-pip-button "+t.prototype.buildCSSClass.call(this)},i.handleClick=function(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];(e=t.prototype.handleClick).call.apply(e,[this].concat(i)),this.player_.pictureInPicture().toggle()},e}(l);s.prototype.controlText_="Picture in Picture",t.registerComponent("PipButton",s);var c=t.getComponent("ControlBar").prototype.options_.children,u=c.indexOf("SettingMenuButton");c.splice(u,0,"PipButton");var d=function(t,e,n){return void 0===n&&(n=window),Array.isArray(t)||(t=[t]),t.forEach(function(t){return n.addEventListener(t,e)}),function(){return t.forEach(function(t){return n.removeEventListener(t,e)})}};i.pipPlayer=null;var h=function(r){function o(t,e){var n;return void 0===e&&(e={}),n=r.call(this,t,e)||this,n.cache_={},n.options_=e,n.parentPlayer=t,n}n(o,r);var a=o.prototype;return a.toggle=function(){i.pipPlayer?this.exit():this.init()},a.init=function(){i.pipPlayer||(this.handleOriginPlayer(),this.createPipPlayer())},a.createPipPlayer=function(){var n=this.parentPlayer,r=this.options_,o=n.id_+"-pip-player",a=t.dom.createEl("video",{id:o,className:"vjs-pip-player"});document.body.appendChild(a);var l=e({},n.options_,n.cache_,{fluid:!0,autoplay:!0,muted:n.muted()}),s=i.pipPlayer=i(a,l);this.wrapper=new p(s,e({},r,{parentPlayer:n})),this.dragzone=s.getChild("PlayToggleLayer"),this.updatePosition(e({},this.cache_,r)),s.ready(function(){s.currentTime(n.currentTime()),s.play()}),!1!==r.draggable&&this.draggable(this.dragzone.el_)},a.handleOriginPlayer=function(){var t=this,e=this.parentPlayer;e.pause(),e.controls(!1),e.addClass("vjs-pip-player-enabled");var n=function(){t.exit()};e.one("loadstart",function(){e.off("play",n),e.one("playing",e.pause)}),e.one("play",n)},a.exit=function(){var t=this.parentPlayer,e=this.wrapper,n=i.pipPlayer;t&&(t.controls(!0),t.removeClass("vjs-pip-player-enabled"),t.paused()&&t.play(),n&&(n.ended()||t.currentTime(n.currentTime()))),n&&(n.dispose(),e.dispose()),i.pipPlayer=null},a.dispose=function(){r.prototype.dispose.call(this),this.parentPlayer=null},a.updatePosition=function(t){var e=t.x,n=t.y;void 0!==e&&void 0!==n&&(this.wrapper.el_.style.bottom=n+"px",this.wrapper.el_.style.left=e+"px")},a.draggable=function(t){var e,n,r=this,o=function(i){i.preventDefault(),r.cache_.x=Math.max(0,Math.min(window.innerWidth-t.offsetWidth,i.clientX-e)),r.cache_.y=Math.max(0,Math.min(window.innerHeight-t.offsetHeight,window.innerHeight-i.clientY-t.offsetHeight+n)),r.updatePosition(r.cache_)};t.addEventListener("mousedown",function(t){t.preventDefault(),e=t.offsetX,n=t.offsetY;var i=d("mousemove",o),a=d("mousemove",function(){r.dragzone.disable(),a()}),p=d("mouseup",function(){p(),i(),a(),setTimeout(function(){r.dragzone.enable()},0)})});var a=function(){var e=r.cache_,n=e.x,i=e.y;r.updatePosition({x:Math.min(n,window.innerWidth-t.offsetWidth),y:Math.min(i,window.innerHeight-t.offsetHeight)})},p=d("resize",a);i.pipPlayer.on("dispose",p)},o}(t.getPlugin("plugin"));t.registerPlugin("pictureInPicture",h)}(videojs);
