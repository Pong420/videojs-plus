{"version":3,"file":"index.js","sources":["../../../source/Utils/List.js","../../../source/Plugin/Playlist/PlayNextSpinner.js","../../../source/Plugin/Playlist/BeforePlayNextLayer.js","../../../source/Plugin/Playlist/ToggleAutoPlayNext.js","../../../source/Plugin/Playlist/PrevNextButton.js","../../../source/Plugin/Playlist/CancelPlayNextEl.js","../../../source/Plugin/Playlist/Playlist.js"],"sourcesContent":["class List {\n  constructor(array, startIndex) {\n    this.values = array.slice(0);\n    this.index_ = startIndex || 0;\n    this.loop_ = true;\n  }\n\n  index(value) {\n    if (typeof value !== 'undefined') {\n      this.index_ = Math.max(0, Math.min(value, this.values.length - 1));\n    } else {\n      return this.index_;\n    }\n  }\n\n  loop(value) {\n    if (typeof value !== 'undefined') {\n      this.loop_ = !!value;\n    } else {\n      return this.loop_;\n    }\n  }\n\n  calc(steps) {\n    const newIndex = this.index_ + steps;\n    const length = this.values.length;\n\n    return this.loop_\n      ? (length + newIndex) % length\n      : Math.max(0, Math.min(newIndex, length - 1));\n  }\n\n  step(steps) {\n    this.index_ = this.calc(steps);\n\n    return this.values[this.index_];\n  }\n\n  current() {\n    return this.values[this.index_];\n  }\n\n  next() {\n    return this.step(1);\n  }\n\n  prev() {\n    return this.step(-1);\n  }\n\n  ended() {\n    return this.index_ === this.values.length - 1;\n  }\n}\n\nexport default List;\n","import videojs from 'video.js';\n\nconst ClickableComponent = videojs.getComponent('ClickableComponent');\n\nclass PlayNextSpinner extends ClickableComponent {\n  buildCSSClass() {\n    return 'vjs-playnext-spinner';\n  }\n\n  createEl() {\n    const el = super.createEl('div', {\n      innerHTML: `\n        <div class=\"vjs-icon-placeholder vjs-icon-play\"></div>\n        <svg width=\"60\" height=\"60\" viewbox=\"0 0 60 60\">\n          <circle cx=\"30\" cy=\"30\" r=\"30\"/>\n          <path class=\"vjs-playnext-spinner-border\" fill=\"#FFF\" transform=\"translate(30, 30)\"/>\n          <circle id=\"donut\" cx=\"30\" cy=\"30\" r=\"27\"/>\n        </svg>\n      `\n    });\n\n    this.path = el.querySelector('path');\n\n    return el;\n  }\n\n  handleClick() {\n    this.player_.getChild('BeforePlayNextLayer').timeup();\n  }\n}\n\nPlayNextSpinner.prototype.controlText_ = 'PlayNext';\n\nvideojs.registerComponent('PlayNextSpinner', PlayNextSpinner);\n\nexport default PlayNextSpinner;\n","import videojs from 'video.js';\n\nimport './PlayNextSpinner';\n\nconst Component = videojs.getComponent('Component');\n\nclass BeforePlayNextLayer extends Component {\n  constructor(player, options) {\n    super(player, options);\n\n    this.addChild('PlayNextSpinner', {}, 2);\n    this.addChild(\n      'CancelPlayNextEl',\n      {\n        text: '&#10005;',\n        className: 'vjs-cancel-playnext-cross'\n      },\n      {},\n      2\n    );\n    this.addChild(\n      'CancelPlayNextEl',\n      {\n        text: 'Cancel',\n        className: 'vjs-cancel-playnext-button'\n      },\n      {},\n      2\n    );\n\n    this.originPoster = player.poster() || player.playlist.current().poster;\n    player.poster(this.getNext().poster);\n\n    // for user click on replay button or select another video\n    const dispose = this.dispose.bind(this);\n    const events = ['timeupdate', 'loadstart'];\n\n    player.one(events, dispose);\n    this.on('dispose', () => {\n      player.off(events, dispose);\n      player.removeClass('vjs-play-next-ready');\n    });\n\n    this.countdown(player.options_.playNextCountDown);\n\n    player.addClass('vjs-play-next-ready');\n  }\n\n  getNext() {\n    const playlist = this.player_.playlist;\n\n    this.next = playlist.values[playlist.calc(1)];\n\n    return this.next;\n  }\n\n  createEl() {\n    const title = this.getNext().title;\n\n    const el = videojs.dom.createEl('div', {\n      className: 'vjs-before-playnext'\n    });\n\n    this.contentEl_ = videojs.dom.createEl('div', {\n      className: 'vjs-before-playnext-content',\n      innerHTML: `\n        <div class=\"vjs-upnext-text\">${this.localize('Up Next')}</div>\n        <div class=\"vjs-playnext-title\">\n            <div>${title}</div>\n        </div>\n      `\n    });\n\n    el.appendChild(this.contentEl_);\n\n    return el;\n  }\n\n  countdown(count) {\n    if (typeof count === 'undefined') {\n      count = 10;\n    }\n\n    if (count == 0) {\n      this.timeup();\n      return false;\n    }\n\n    let _this = this,\n      a = 0,\n      p = Math.PI,\n      t = count;\n\n    t = (t / 360) * 1000;\n\n    (function draw() {\n      a++;\n      a %= 360;\n      let r = (a * p) / 180,\n        x = Math.sin(r) * 125,\n        y = Math.cos(r) * -125,\n        mid = a > 180 ? 1 : 0,\n        anim = 'M 0 0 v -125 A 125 125 1 ' + mid + ' 1 ' + x + ' ' + y + ' z';\n\n      _this.getChild('PlayNextSpinner').path.setAttribute('d', anim);\n\n      if (a === 0) {\n        _this.timeup();\n      } else {\n        _this.timer = setTimeout(draw, t);\n      }\n    })();\n  }\n\n  timeup() {\n    this.player_.playlist.next();\n    this.player_.playlist.play();\n    this.dispose();\n  }\n\n  cancel() {\n    this.player_.poster(this.originPoster);\n\n    return this;\n  }\n\n  dispose() {\n    clearTimeout(this.timer);\n\n    this.player_.removeChild(this);\n\n    super.dispose();\n  }\n}\n\nfunction playNext() {\n  const player = this.player_;\n  const { playlist } = player;\n  const haveNextVideo = playlist.loop() || !playlist.ended();\n\n  if (playlist.autoPlayNext() && haveNextVideo) {\n    const controlbar = player.getChild('ControlBar');\n    const index = player.children().indexOf(controlbar) - 1;\n\n    player.addChild('BeforePlayNextLayer', {}, index);\n  } else {\n    player.poster(playlist.current().poster || '');\n  }\n}\n\nvideojs.registerPlugin('playNext', playNext);\nvideojs.registerComponent('BeforePlayNextLayer', BeforePlayNextLayer);\n","import videojs from 'video.js';\n\nconst SettingMenuButton = videojs.getComponent('SettingMenuButton');\nconst SettingOnOffItem = videojs.getComponent('SettingOnOffItem');\n\nclass ToggleAutoPlayNext extends SettingOnOffItem {\n  constructor(player) {\n    super(player, {\n      name: 'ToggleAutoPlayNext',\n      label: 'Autoplay',\n      icon: 'vjs-icon-next-item'\n    });\n\n    this.updateVisibility();\n    this.addClass('vjs-setting-autoplay');\n\n    player.on('playlist', () => {\n      this.updateVisibility();\n      this.update(player.playlist.autoPlayNext_);\n    });\n\n    player.on('autoplaynext', (_, active) => {\n      this.update(active);\n    });\n  }\n\n  updateVisibility() {\n    const { playlist } = this.player_;\n\n    if (playlist && playlist.values.length > 1) {\n      this.show();\n    } else {\n      this.hide();\n    }\n  }\n\n  update(active) {\n    super.update(active);\n\n    const { playlist } = this.player_;\n\n    if (playlist.autoPlayNext_ !== this.active) {\n      this.player_.playlist.autoPlayNext(this.active);\n    }\n  }\n}\n\nvideojs.registerComponent('ToggleAutoPlayNext', ToggleAutoPlayNext);\n\nSettingMenuButton.prototype.options_.entries.splice(0, 0, 'ToggleAutoPlayNext');\n\nexport default ToggleAutoPlayNext;\n","import videojs from 'video.js';\n\nconst Button = videojs.getComponent('Button');\n\nclass PrevNextButton extends Button {\n  constructor(player, options) {\n    super(player, options);\n\n    this.updateVisibility();\n    this.controlText(options.controlText);\n\n    player.on('playlist', this.updateVisibility.bind(this));\n  }\n\n  buildCSSClass() {\n    return `${this.options_.className} ${super.buildCSSClass()}`;\n  }\n\n  updateVisibility() {\n    const playlist = this.player_.playlist;\n\n    if (playlist && playlist.values.length > 1) {\n      this.show();\n    } else {\n      this.hide();\n    }\n  }\n\n  createEl(tag, _, attributes) {\n    return super.createEl(\n      tag,\n      {\n        innerHTML: `<span aria-hidden=\"true\" class=\"vjs-icon-placeholder ${this.options_.icon}\"></span>`\n      },\n      attributes\n    );\n  }\n\n  handleClick() {\n    // prev / next\n    const type = this.options_.controlText.toLowerCase();\n\n    this.player_.playlist[type]();\n    this.player_.playlist.play();\n  }\n}\n\nconst ControlBar = videojs.getComponent('ControlBar');\nconst children = ControlBar.prototype.options_.children;\nconst indexOfPlayToggle = children.indexOf('PlayToggle');\n\nif (indexOfPlayToggle !== -1) {\n  children.splice(0, 0, {\n    name: 'PrevNextButton',\n    className: 'vjs-prev-control',\n    icon: 'vjs-icon-previous-item',\n    controlText: 'Prev'\n  });\n\n  children.splice(indexOfPlayToggle + 2, 0, {\n    name: 'PrevNextButton',\n    className: 'vjs-next-control',\n    icon: 'vjs-icon-next-item',\n    controlText: 'Next'\n  });\n}\n\nvideojs.registerComponent('PrevNextButton', PrevNextButton);\n\nexport default PrevNextButton;\n","import videojs from 'video.js';\n\nconst ClickableComponent = videojs.getComponent('ClickableComponent');\n\nclass CancelPlayNextEl extends ClickableComponent {\n  constructor(player, options) {\n    super(player, options);\n\n    this.el_.querySelector('.vjs-icon-placeholder').innerHTML = this.localize(\n      options.text\n    );\n  }\n\n  buildCSSClass() {\n    return `vjs-cancel-playnext ${this.options_.className}`;\n  }\n\n  handleClick() {\n    this.player_.getChild('BeforePlayNextLayer').cancel().dispose();\n  }\n}\n\nCancelPlayNextEl.prototype.controlText_ = 'Cancel PlayNext';\n\nvideojs.registerComponent('CancelPlayNextEl', CancelPlayNextEl);\n\nexport default CancelPlayNextEl;\n","import videojs from 'video.js';\nimport List from '../../Utils/List.js';\n\nimport './BeforePlayNextLayer.js';\nimport './ToggleAutoPlayNext.js';\nimport './PrevNextButton.js';\nimport './CancelPlayNextEl.js';\n\nimport './Playlist.scss';\n\nclass PlayList extends List {\n  constructor(player, array, startIndex = 0) {\n    super(array, startIndex);\n\n    this.player_ = player;\n\n    this.loadPoster_ = true;\n\n    this.autoPlayNext_ = true;\n\n    this.play(startIndex);\n\n    player.off('ended', player.playNext);\n    player.on('ended', player.playNext);\n  }\n\n  autoPlayNext(value) {\n    if (typeof value !== 'undefined') {\n      this.autoPlayNext_ = !!value;\n    } else {\n      return this.autoPlayNext_;\n    }\n\n    this.player_.trigger('autoplaynext', this.autoPlayNext_);\n  }\n\n  play(index) {\n    if (typeof index !== 'undefined') {\n      this.index(index);\n    }\n\n    const current = this.current();\n    const { poster, sources, title } = current;\n    const player = this.player_;\n    const addPoster = () => {\n      player.poster(poster || '');\n    };\n\n    player.title('');\n    player.poster('');\n\n    if (this.loadPoster_) {\n      this.loadPoster_ = false;\n\n      // For Safari, poster will not hidden when video playing\n      if (player.autoplay()) {\n        player.one('autoplay-failure', addPoster);\n      } else {\n        addPoster();\n      }\n    } else {\n      player.one('loadedmetadata', () => {\n        player.play();\n      });\n    }\n\n    if (player.preload() !== 'none') {\n      player.addClass('vjs-waiting');\n      player.one('loadedmetadata', () => {\n        player.removeClass('vjs-waiting');\n      });\n    }\n\n    player.src(sources);\n    player.title(title || '');\n\n    player.trigger('playlistchange', {\n      ...current,\n      index: this.index()\n    });\n  }\n}\n\nvideojs.registerPlugin('setPlayList', function (playlist, startIndex) {\n  const player = this.player_;\n\n  player.playlist = new PlayList(player, playlist, startIndex);\n\n  player.trigger('playlist', playlist);\n});\n\nvideojs.hook('setup', vjsPlayer => {\n  const { playlist } = vjsPlayer.options_;\n\n  if (playlist && playlist.length) {\n    const startIndex = playlist.findIndex(v => v.default);\n\n    vjsPlayer.setPlayList(playlist, startIndex);\n  }\n});\n"],"names":["List","array","startIndex","values","slice","index_","loop_","index","value","Math","max","min","length","loop","calc","steps","newIndex","step","current","next","prev","ended","ClickableComponent","videojs","getComponent","PlayNextSpinner","buildCSSClass","createEl","el","innerHTML","path","querySelector","handleClick","player_","getChild","timeup","prototype","controlText_","registerComponent","Component","BeforePlayNextLayer","player","options","addChild","text","className","originPoster","poster","playlist","getNext","dispose","bind","events","one","on","off","removeClass","countdown","options_","playNextCountDown","addClass","title","dom","contentEl_","localize","appendChild","count","_this","a","p","PI","t","draw","r","x","sin","y","cos","mid","anim","setAttribute","timer","setTimeout","play","cancel","clearTimeout","removeChild","playNext","haveNextVideo","autoPlayNext","controlbar","children","indexOf","registerPlugin","SettingMenuButton","SettingOnOffItem","ToggleAutoPlayNext","name","label","icon","updateVisibility","update","autoPlayNext_","_","active","show","hide","entries","splice","Button","PrevNextButton","controlText","tag","attributes","type","toLowerCase","ControlBar","indexOfPlayToggle","CancelPlayNextEl","el_","PlayList","loadPoster_","trigger","sources","addPoster","autoplay","preload","src","hook","vjsPlayer","findIndex","v","setPlayList"],"mappings":"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"}