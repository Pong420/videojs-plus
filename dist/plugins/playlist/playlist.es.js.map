{"version":3,"file":"playlist.es.js","sources":["../../../source/Utils/List.js","../../../source/Plugin/Playlist/PlayNextSpinner.js","../../../source/Plugin/Playlist/BeforePlayNextLayer.js","../../../source/Plugin/Playlist/ToggleAutoPlayNext.js","../../../source/Plugin/Playlist/PrevNextButton.js","../../../source/Plugin/Playlist/CancelPlayNextEl.js","../../../source/Plugin/Playlist/Playlist.js"],"sourcesContent":["class List {\n  constructor(array, startIndex) {\n    this.values = array.slice(0);\n    this.index_ = startIndex || 0;\n    this.loop_ = true;\n  }\n\n  index(value) {\n    if (typeof value !== 'undefined') {\n      this.index_ = Math.max(0, Math.min(value, this.values.length - 1));\n    } else {\n      return this.index_;\n    }\n  }\n\n  loop(value) {\n    if (typeof value !== 'undefined') {\n      this.loop_ = !!value;\n    } else {\n      return this.loop_;\n    }\n  }\n\n  calc(steps) {\n    const newIndex = this.index_ + steps;\n    const length = this.values.length;\n\n    return this.loop_\n      ? (length + newIndex) % length\n      : Math.max(0, Math.min(newIndex, length - 1));\n  }\n\n  step(steps) {\n    this.index_ = this.calc(steps);\n\n    return this.values[this.index_];\n  }\n\n  current() {\n    return this.values[this.index_];\n  }\n\n  next() {\n    return this.step(1);\n  }\n\n  prev() {\n    return this.step(-1);\n  }\n\n  ended() {\n    return this.index_ === this.values.length - 1;\n  }\n}\n\nexport default List;\n","import videojs from 'video.js';\n\nconst ClickableComponent = videojs.getComponent('ClickableComponent');\n\nclass PlayNextSpinner extends ClickableComponent {\n  buildCSSClass() {\n    return 'vjs-playnext-spinner';\n  }\n\n  createEl() {\n    const el = super.createEl('div', {\n      innerHTML: `\n        <div class=\"vjs-icon-placeholder vjs-icon-play\"></div>\n        <svg width=\"60\" height=\"60\" viewbox=\"0 0 60 60\">\n          <circle cx=\"30\" cy=\"30\" r=\"30\"/>\n          <path class=\"vjs-playnext-spinner-border\" fill=\"#FFF\" transform=\"translate(30, 30)\"/>\n          <circle id=\"donut\" cx=\"30\" cy=\"30\" r=\"27\"/>\n        </svg>\n      `\n    });\n\n    this.path = el.querySelector('path');\n\n    return el;\n  }\n\n  handleClick() {\n    this.player_.getChild('BeforePlayNextLayer').timeup();\n  }\n}\n\nPlayNextSpinner.prototype.controlText_ = 'PlayNext';\n\nvideojs.registerComponent('PlayNextSpinner', PlayNextSpinner);\n\nexport default PlayNextSpinner;\n","import videojs from 'video.js';\n\nimport './PlayNextSpinner';\n\nconst Component = videojs.getComponent('Component');\n\nclass BeforePlayNextLayer extends Component {\n  constructor(player, options) {\n    super(player, options);\n\n    this.addChild('PlayNextSpinner', {}, 2);\n    this.addChild(\n      'CancelPlayNextEl',\n      {\n        text: '&#10005;',\n        className: 'vjs-cancel-playnext-cross'\n      },\n      {},\n      2\n    );\n    this.addChild(\n      'CancelPlayNextEl',\n      {\n        text: 'Cancel',\n        className: 'vjs-cancel-playnext-button'\n      },\n      {},\n      2\n    );\n\n    this.originPoster = player.poster() || player.playlist.current().poster;\n    player.poster(this.getNext().poster);\n\n    // for user click on replay button or select another video\n    const dispose = this.dispose.bind(this);\n    const events = ['timeupdate', 'loadstart'];\n\n    player.one(events, dispose);\n    this.on('dispose', () => {\n      player.off(events, dispose);\n      player.removeClass('vjs-play-next-ready');\n    });\n\n    this.countdown(player.options_.playNextCountDown);\n\n    player.addClass('vjs-play-next-ready');\n  }\n\n  getNext() {\n    const playlist = this.player_.playlist;\n\n    this.next = playlist.values[playlist.calc(1)];\n\n    return this.next;\n  }\n\n  createEl() {\n    const title = this.getNext().title;\n\n    const el = videojs.dom.createEl('div', {\n      className: 'vjs-before-playnext'\n    });\n\n    this.contentEl_ = videojs.dom.createEl('div', {\n      className: 'vjs-before-playnext-content',\n      innerHTML: `\n        <div class=\"vjs-upnext-text\">${this.localize('Up Next')}</div>\n        <div class=\"vjs-playnext-title\">\n            <div>${title}</div>\n        </div>\n      `\n    });\n\n    el.appendChild(this.contentEl_);\n\n    return el;\n  }\n\n  countdown(count) {\n    if (typeof count === 'undefined') {\n      count = 10;\n    }\n\n    if (count == 0) {\n      this.timeup();\n      return false;\n    }\n\n    let _this = this,\n      a = 0,\n      p = Math.PI,\n      t = count;\n\n    t = (t / 360) * 1000;\n\n    (function draw() {\n      a++;\n      a %= 360;\n      let r = (a * p) / 180,\n        x = Math.sin(r) * 125,\n        y = Math.cos(r) * -125,\n        mid = a > 180 ? 1 : 0,\n        anim = 'M 0 0 v -125 A 125 125 1 ' + mid + ' 1 ' + x + ' ' + y + ' z';\n\n      _this.getChild('PlayNextSpinner').path.setAttribute('d', anim);\n\n      if (a === 0) {\n        _this.timeup();\n      } else {\n        _this.timer = setTimeout(draw, t);\n      }\n    })();\n  }\n\n  timeup() {\n    this.player_.playlist.next();\n    this.player_.playlist.play();\n    this.dispose();\n  }\n\n  cancel() {\n    this.player_.poster(this.originPoster);\n\n    return this;\n  }\n\n  dispose() {\n    clearTimeout(this.timer);\n\n    this.player_.removeChild(this);\n\n    super.dispose();\n  }\n}\n\nfunction playNext() {\n  const player = this.player_;\n  const { playlist } = player;\n  const haveNextVideo = playlist.loop() || !playlist.ended();\n\n  if (playlist.autoPlayNext() && haveNextVideo) {\n    const controlbar = player.getChild('ControlBar');\n    const index = player.children().indexOf(controlbar) - 1;\n\n    player.addChild('BeforePlayNextLayer', {}, index);\n  } else {\n    player.poster(playlist.current().poster || '');\n  }\n}\n\nvideojs.registerPlugin('playNext', playNext);\nvideojs.registerComponent('BeforePlayNextLayer', BeforePlayNextLayer);\n","import videojs from 'video.js';\n\nconst SettingMenuButton = videojs.getComponent('SettingMenuButton');\nconst SettingOnOffItem = videojs.getComponent('SettingOnOffItem');\n\nclass ToggleAutoPlayNext extends SettingOnOffItem {\n  constructor(player) {\n    super(player, {\n      name: 'ToggleAutoPlayNext',\n      label: 'Autoplay',\n      icon: 'vjs-icon-next-item'\n    });\n\n    this.updateVisibility();\n    this.addClass('vjs-setting-autoplay');\n\n    player.on('playlist', () => {\n      this.updateVisibility();\n      this.update(player.playlist.autoPlayNext_);\n    });\n\n    player.on('autoplaynext', (_, active) => {\n      this.update(active);\n    });\n  }\n\n  updateVisibility() {\n    const { playlist } = this.player_;\n\n    if (playlist && playlist.values.length > 1) {\n      this.show();\n    } else {\n      this.hide();\n    }\n  }\n\n  update(active) {\n    super.update(active);\n\n    const { playlist } = this.player_;\n\n    if (playlist.autoPlayNext_ !== this.active) {\n      this.player_.playlist.autoPlayNext(this.active);\n    }\n  }\n}\n\nvideojs.registerComponent('ToggleAutoPlayNext', ToggleAutoPlayNext);\n\nSettingMenuButton.prototype.options_.entries.splice(0, 0, 'ToggleAutoPlayNext');\n\nexport default ToggleAutoPlayNext;\n","import videojs from 'video.js';\n\nconst Button = videojs.getComponent('Button');\n\nclass PrevNextButton extends Button {\n  constructor(player, options) {\n    super(player, options);\n\n    this.updateVisibility();\n    this.controlText(options.controlText);\n\n    player.on('playlist', this.updateVisibility.bind(this));\n  }\n\n  buildCSSClass() {\n    return `${this.options_.className} ${super.buildCSSClass()}`;\n  }\n\n  updateVisibility() {\n    const playlist = this.player_.playlist;\n\n    if (playlist && playlist.values.length > 1) {\n      this.show();\n    } else {\n      this.hide();\n    }\n  }\n\n  createEl(tag, _, attributes) {\n    return super.createEl(\n      tag,\n      {\n        innerHTML: `<span aria-hidden=\"true\" class=\"vjs-icon-placeholder ${this.options_.icon}\"></span>`\n      },\n      attributes\n    );\n  }\n\n  handleClick() {\n    // prev / next\n    const type = this.options_.controlText.toLowerCase();\n\n    this.player_.playlist[type]();\n    this.player_.playlist.play();\n  }\n}\n\nconst ControlBar = videojs.getComponent('ControlBar');\nconst children = ControlBar.prototype.options_.children;\nconst indexOfPlayToggle = children.indexOf('PlayToggle');\n\nif (indexOfPlayToggle !== -1) {\n  children.splice(0, 0, {\n    name: 'PrevNextButton',\n    className: 'vjs-prev-control',\n    icon: 'vjs-icon-previous-item',\n    controlText: 'Prev'\n  });\n\n  children.splice(indexOfPlayToggle + 2, 0, {\n    name: 'PrevNextButton',\n    className: 'vjs-next-control',\n    icon: 'vjs-icon-next-item',\n    controlText: 'Next'\n  });\n}\n\nvideojs.registerComponent('PrevNextButton', PrevNextButton);\n\nexport default PrevNextButton;\n","import videojs from 'video.js';\n\nconst ClickableComponent = videojs.getComponent('ClickableComponent');\n\nclass CancelPlayNextEl extends ClickableComponent {\n  constructor(player, options) {\n    super(player, options);\n\n    this.el_.querySelector('.vjs-icon-placeholder').innerHTML = this.localize(\n      options.text\n    );\n  }\n\n  buildCSSClass() {\n    return `vjs-cancel-playnext ${this.options_.className}`;\n  }\n\n  handleClick() {\n    this.player_.getChild('BeforePlayNextLayer').cancel().dispose();\n  }\n}\n\nCancelPlayNextEl.prototype.controlText_ = 'Cancel PlayNext';\n\nvideojs.registerComponent('CancelPlayNextEl', CancelPlayNextEl);\n\nexport default CancelPlayNextEl;\n","import videojs from 'video.js';\nimport List from '../../Utils/List.js';\n\nimport './BeforePlayNextLayer.js';\nimport './ToggleAutoPlayNext.js';\nimport './PrevNextButton.js';\nimport './CancelPlayNextEl.js';\n\nimport './Playlist.scss';\n\nclass PlayList extends List {\n  constructor(player, array, startIndex = 0) {\n    super(array, startIndex);\n\n    this.player_ = player;\n\n    this.loadPoster_ = true;\n\n    this.autoPlayNext_ = true;\n\n    this.play(startIndex);\n\n    player.off('ended', player.playNext);\n    player.on('ended', player.playNext);\n  }\n\n  autoPlayNext(value) {\n    if (typeof value !== 'undefined') {\n      this.autoPlayNext_ = !!value;\n    } else {\n      return this.autoPlayNext_;\n    }\n\n    this.player_.trigger('autoplaynext', this.autoPlayNext_);\n  }\n\n  play(index) {\n    if (typeof index !== 'undefined') {\n      this.index(index);\n    }\n\n    const current = this.current();\n    const { poster, sources, title } = current;\n    const player = this.player_;\n    const addPoster = () => {\n      player.poster(poster || '');\n    };\n\n    player.title('');\n    player.poster('');\n\n    if (this.loadPoster_) {\n      this.loadPoster_ = false;\n\n      // For Safari, poster will not hidden when video playing\n      if (player.autoplay()) {\n        player.one('autoplay-failure', addPoster);\n      } else {\n        addPoster();\n      }\n    } else {\n      player.one('loadedmetadata', () => {\n        player.play();\n      });\n    }\n\n    if (player.preload() !== 'none') {\n      player.addClass('vjs-waiting');\n      player.one('loadedmetadata', () => {\n        player.removeClass('vjs-waiting');\n      });\n    }\n\n    player.src(sources);\n    player.title(title || '');\n\n    player.trigger('playlistchange', {\n      ...current,\n      index: this.index()\n    });\n  }\n}\n\nvideojs.registerPlugin('setPlayList', function (playlist, startIndex) {\n  const player = this.player_;\n\n  player.playlist = new PlayList(player, playlist, startIndex);\n\n  player.trigger('playlist', playlist);\n});\n\nvideojs.hook('setup', vjsPlayer => {\n  const { playlist } = vjsPlayer.options_;\n\n  if (playlist && playlist.length) {\n    const startIndex = playlist.findIndex(v => v.default);\n\n    vjsPlayer.setPlayList(playlist, startIndex);\n  }\n});\n"],"names":["List","array","startIndex","values","slice","index_","loop_","index","value","Math","max","min","length","loop","calc","steps","newIndex","step","current","next","prev","ended","ClickableComponent","videojs","getComponent","PlayNextSpinner","buildCSSClass","createEl","el","innerHTML","path","querySelector","handleClick","player_","getChild","timeup","prototype","controlText_","registerComponent","Component","BeforePlayNextLayer","player","options","addChild","text","className","originPoster","poster","playlist","getNext","dispose","bind","events","one","on","off","removeClass","countdown","options_","playNextCountDown","addClass","title","dom","contentEl_","localize","appendChild","count","_this","a","p","PI","t","draw","r","x","sin","y","cos","mid","anim","setAttribute","timer","setTimeout","play","cancel","clearTimeout","removeChild","playNext","haveNextVideo","autoPlayNext","controlbar","children","indexOf","registerPlugin","SettingMenuButton","SettingOnOffItem","ToggleAutoPlayNext","name","label","icon","updateVisibility","update","autoPlayNext_","_","active","show","hide","entries","splice","Button","PrevNextButton","controlText","tag","attributes","type","toLowerCase","ControlBar","indexOfPlayToggle","CancelPlayNextEl","el_","PlayList","loadPoster_","trigger","sources","addPoster","autoplay","preload","src","hook","vjsPlayer","findIndex","v","setPlayList"],"mappings":"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"}